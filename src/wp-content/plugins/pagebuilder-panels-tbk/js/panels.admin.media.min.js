/*
 GPL 2.0 http://www.gnu.org/licenses/gpl-2.0.html
*/
jQuery(function(c){var e=wp.media.editor.insert;wp.media.editor.insert=function(b){if(!c("#wp-content-wrap").hasClass("panels-active"))return e(b);if(-1!==b.indexOf("[gallery")){var a=wp.media.gallery.attachments(wp.shortcode.next("gallery",b).shortcode).models.map(function(a){return a.id}),a=c("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Gallery",{ids:a.join(",")});null==a?e(b):panels.addPanel(a,null,null,!0)}else if(-1!==b.indexOf("<a ")||-1!==b.indexOf("<img ")){var d=c(b);if("A"==
d.prop("tagName")&&"IMG"==d.children().eq(0).prop("tagName"))a=c("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{href:d.attr("href"),src:d.children().eq(0).attr("src")});else if("IMG"==d.prop("tagName"))a=c("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{src:d.attr("src")});else if("A"==d.prop("tagName")&&(-1!==d.attr("href").indexOf(".mp4")||-1!==d.attr("href").indexOf(".avi")))a=c("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Video",
{url:d.attr("href")});null==a?e(b):panels.addPanel(a,null,null,!0)}else a=c("#panels-dialog").panelsCreatePanel("WP_Widget_Text",{text:b}),null==a?e(b):panels.addPanel(a,null,null,!0),e(b)};c("body").on({click:function(){if(!("undefined"===typeof wp||!wp.media||!wp.media.gallery)){event.preventDefault();c(this);var b=c(".panels-admin-dialog:visible"),a=b.find('*[name$="[ids]"]').val();if(0===a.indexOf("{demo")||0===a.indexOf("{default"))a="-";""==a&&null==c("#post_ID").val()&&(a="-");b.find(".ui-dialog-content").dialog("close");
a=wp.media.gallery.edit('[gallery ids="'+a+'"]');a.state("gallery-edit").on("update",function(a){b.find(".ui-dialog-content").dialog("open");a=a.models.map(function(a){return a.id});b.find('input[name$="[ids]"]').val(a.join(","))});a.on("escape",function(){b.find(".ui-dialog-content").dialog("open")});return!1}}},".so-gallery-widget-select-attachments")});